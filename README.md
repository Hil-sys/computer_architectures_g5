# Архивация "лишних файлов"

Это простой учебный проект, написанный на **Bash**. Он состоит из двух скриптов: основного (`disk_monitor.sh`) и тестового (`run_tests.sh`).

Основной скрипт предназначен для мониторинга размера указанной папки. Если размер папки превышает заданный порог (в МБ), скрипт автоматически архивирует M самых старых файлов в отдельную директорию бэкапов и удаляет оригиналы, освобождая место.

## Основные возможности

* **Валидация аргументов:** Проверяет, что все 3 аргумента (путь к папке, порог в МБ, кол-во файлов) переданы корректно.
* **Расчет размера:** Вычисляет размер целевой папки в Мегабайтах (`du -sm`).
* **Проверка порога:** Сравнивает текущий размер папки с заданным порогом.
* **Архивация:** Находит `M` самых старых файлов (по дате модификации) и упаковывает их в `.tar.gz` архив.
* **Очистка:** Удаляет оригинальные файлы **только** после успешного создания архива.
* **Логирование:** Ведет собственный лог-файл в `/tmp/disk_monitor_*.log`.
* **Тестирование:** Сопровождается тестовым скриптом (`run_tests.sh`), который покрывает основные сценарии работы.

## Использование

1.  Подготовка к запуску:
    ```bash
    chmod +x disk_monitor.sh
    chmod +x run_tests.sh
    ```

2.  Можно отдельно запустить первый скрипт:
    **Пример:**
    ```bash
    # Следить за папкой ./logs, если ее размер > 100МБ, архивировать 50 старых файлов
    ./disk_monitor.sh ./logs 100 50
    ```
    Папка с бэкапами (`backup_dir`) будет создана рядом с папкой логов.

## Автоматическое тестирование

Для проверки корректности работы основного скрипта просто запустите тестовый скрипт.

Он автоматически создаст тестовое окружение (`simple_test_env`), проведет серию тестов (включая некорректный ввод, режим бездействия и успешную архивацию) и затем удалит за собой все временные файлы.

```bash
./run_tests.sh
```

---

**Примечание:** Этот проект был создан в учебных целях для демонстрации базовых навыков написания скриптов на Bash, включая обработку аргументов, работу с файловой системой и написание автоматизированных тестов.
